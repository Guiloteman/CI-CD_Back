name: ğŸ§ª CI - Ejecutar Pruebas de Backend (TESTS)

# 1. DefiniciÃ³n de cuÃ¡ndo se ejecuta el flujo de trabajo
on:
  # Se ejecuta ante cualquier Pull Request (PR) dirigido a la rama 'main'
  pull_request:
    branches: [ main ]
  
  # Permite la ejecuciÃ³n manual desde la pestaÃ±a 'Actions' de GitHub
  workflow_dispatch:
  
  # (Opcional) Si quieres que tambiÃ©n se ejecute en cada 'push' directo a 'main'
  # push:
  #   branches: [ main ]

# DefiniciÃ³n de los 'jobs' (tareas)
jobs:
  build_and_test:
    # El trabajo se ejecutarÃ¡ en un entorno Linux (ubuntu-latest)
    runs-on: ubuntu-latest

    # DefiniciÃ³n de las variables de entorno si fueran necesarias
    # env:
    #   MY_ENV_VAR: valor_a_usar
      
    steps:
    # Paso 1: Checkout del cÃ³digo (obligatorio)
    - name: ğŸ“¦ Checkout del cÃ³digo
      uses: actions/checkout@v4
      
    # Paso 2: InstalaciÃ³n del SDK de .NET
    - name: âš™ï¸ Configurar .NET 8.x
      uses: actions/setup-dotnet@v4
      with:
        # AsegÃºrate de que esta versiÃ³n coincida con tu proyecto
        dotnet-version: '8.x'

    # Paso 3: Restaurar dependencias de NuGet
    - name: ğŸ” Restaurar dependencias de NuGet
      run: dotnet restore
      
    # Paso 4: Construir la soluciÃ³n (opcional, pero buena prÃ¡ctica)
    - name: ğŸ—ï¸ Construir soluciÃ³n
      run: dotnet build --no-restore

    # Paso 5: Ejecutar los tests (Â¡El paso principal!)
    - name: âœ… Ejecutar Pruebas (Tests)
      # El comando 'dotnet test' buscarÃ¡ y ejecutarÃ¡ todos los proyectos de pruebas en la soluciÃ³n.
      # Se incluye '--no-build' ya que construimos en el paso anterior.
      run: dotnet test --no-build --verbosity normal